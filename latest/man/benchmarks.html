<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Benchmarks · uCSV.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>uCSV.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" action="../search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="defaults.html">Getting Started</a></li><li><a class="toctext" href="headers.html">Headers</a></li><li><a class="toctext" href="dataframes.html">Reading into DataFrames</a></li><li><a class="toctext" href="delimiters.html">Delimiters</a></li><li><a class="toctext" href="missingdata.html">Missing Data</a></li><li><a class="toctext" href="declaring-column-element-types.html">Declaring Column Element Types</a></li><li><a class="toctext" href="declaring-column-vector-types.html">Declaring Column Vector Types</a></li><li><a class="toctext" href="international.html">International Representations for Numbers</a></li><li><a class="toctext" href="customparsers.html">Custom Parsers</a></li><li><a class="toctext" href="quotes-escapes.html">Quotes and Escapes</a></li><li><a class="toctext" href="comments-skiplines.html">Skipping Comments and Rows</a></li><li><a class="toctext" href="malformed.html">Malformed Data</a></li><li><a class="toctext" href="url.html">Reading Data from URLs</a></li><li><a class="toctext" href="compressed.html">Reading Compressed Datasets</a></li><li><a class="toctext" href="unsupported.html">Common Formatting Issues</a></li><li><a class="toctext" href="write.html">Writing Data</a></li><li class="current"><a class="toctext" href="benchmarks.html">Benchmarks</a><ul class="internal"><li><a class="toctext" href="#Read-1">Read</a></li><li><a class="toctext" href="#Write-1">Write</a></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href="benchmarks.html">Benchmarks</a></li></ul><a class="edit-page" href="https://github.com/cjprybol/uCSV.jl/tree/00527dc49f57a604bcb4c4a57cc4b0f1e5a6cf8b/docs/src/man/benchmarks.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Benchmarks</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Benchmarks-1" href="#Benchmarks-1">Benchmarks</a></h1><p>Note these are not exhaustive, but they do cover various common formats and try to constrain outputs to a common format for evaluating on a pseudo-level playing-field. This does not necessarily reflect the strengths or weaknesses of the other packages relative to uCSV, it&#39;s simply to observe the relative times and memory usage required to perform equivalent tasks.</p><p>All runs are done <em>WITHOUT</em> warmups or precompiling. Reading CSV files in Julia is an interesting problem. A major strength of Julia is that it will compile functions on the first call, making all successive calls faster (often 3-4 orders of magnitude faster). But very rarely will users need to read the same file twice, making the precompiled runtimes for these functions a poor reflection of real-world use, and thus they are not shown.</p><h2><a class="nav-anchor" id="Read-1" href="#Read-1">Read</a></h2><h3><a class="nav-anchor" id="Setup-1" href="#Setup-1">Setup</a></h3><p>All data will be read into equivalent DataFrames</p><pre><code class="language-julia">using uCSV, CSV, TextParse, CodecZlib, Nulls, DataFrames, Base.Test
GDS = GzipDecompressionStream;

function textparse2DF(x)
    DataFrame(Any[x[1]...], Symbol.(x[2]))
end</code></pre><h3><a class="nav-anchor" id="[Iris](https://github.com/cjprybol/uCSV.jl/blob/master/test/data/iris.csv.gz)-1" href="#[Iris](https://github.com/cjprybol/uCSV.jl/blob/master/test/data/iris.csv.gz)-1"><a href="https://github.com/cjprybol/uCSV.jl/blob/master/test/data/iris.csv.gz">Iris</a></a></h3><pre><code class="language-julia">iris_file = joinpath(Pkg.dir(&quot;uCSV&quot;), &quot;test&quot;, &quot;data&quot;, &quot;iris.csv.gz&quot;);
@time df1 = DataFrame(uCSV.read(GDS(open(iris_file)), header=1));
@time df2 = CSV.read(GDS(open(iris_file)), types=Dict(6=&gt;String));
@time df3 = textparse2DF(csvread(GDS(open(iris_file)), pooledstrings=false));
@test df1 == df2 == df3</code></pre><pre><code class="language-julia">julia&gt; iris_file = joinpath(Pkg.dir(&quot;uCSV&quot;), &quot;test&quot;, &quot;data&quot;, &quot;iris.csv.gz&quot;);

julia&gt; @time df1 = DataFrame(uCSV.read(GDS(open(iris_file)), header=1));
  2.883561 seconds (2.16 M allocations: 112.477 MiB, 1.57% gc time)

julia&gt; @time df2 = CSV.read(GDS(open(iris_file)), types=Dict(6=&gt;String));
  6.311389 seconds (4.18 M allocations: 206.229 MiB, 3.63% gc time)

julia&gt; @time df3 = textparse2DF(csvread(GDS(open(iris_file)), pooledstrings=false));
  2.719340 seconds (1.76 M allocations: 95.649 MiB, 3.09% gc time)

julia&gt; @test df1 == df2 == df3
Test Passed
</code></pre><h3><a class="nav-anchor" id="[0s-1s](https://github.com/cjprybol/uCSV.jl/blob/master/test/data/0s-1s.csv.gz)-1" href="#[0s-1s](https://github.com/cjprybol/uCSV.jl/blob/master/test/data/0s-1s.csv.gz)-1"><a href="https://github.com/cjprybol/uCSV.jl/blob/master/test/data/0s-1s.csv.gz">0s-1s</a></a></h3><pre><code class="language-julia">ints_file = joinpath(Pkg.dir(&quot;uCSV&quot;), &quot;test&quot;, &quot;data&quot;, &quot;0s-1s.csv.gz&quot;);
@time df1 = DataFrame(uCSV.read(GDS(open(ints_file)), header=1));
@time df2 = CSV.read(GDS(open(ints_file)));
@time df3 = textparse2DF(csvread(GDS(open(ints_file))));
@test df1 == df2 == df3</code></pre><pre><code class="language-julia">julia&gt; ints_file = joinpath(Pkg.dir(&quot;uCSV&quot;), &quot;test&quot;, &quot;data&quot;, &quot;0s-1s.csv.gz&quot;);

julia&gt; @time df1 = DataFrame(uCSV.read(GDS(open(ints_file)), header=1));
  5.227549 seconds (13.26 M allocations: 673.321 MiB, 3.64% gc time)

julia&gt; @time df2 = CSV.read(GDS(open(ints_file)));
 11.261905 seconds (10.23 M allocations: 364.527 MiB, 3.33% gc time)

julia&gt; @time df3 = textparse2DF(csvread(GDS(open(ints_file))));
  2.629143 seconds (1.80 M allocations: 188.707 MiB, 3.60% gc time)

julia&gt; @test df1 == df2 == df3
Test Passed
</code></pre><h3><a class="nav-anchor" id="[Flights](https://github.com/cjprybol/uCSV.jl/blob/master/test/data/2010_BSA_Carrier_PUF.csv.gz)-1" href="#[Flights](https://github.com/cjprybol/uCSV.jl/blob/master/test/data/2010_BSA_Carrier_PUF.csv.gz)-1"><a href="https://github.com/cjprybol/uCSV.jl/blob/master/test/data/2010_BSA_Carrier_PUF.csv.gz">Flights</a></a></h3><pre><code class="language-julia">carrier_file = joinpath(Pkg.dir(&quot;uCSV&quot;), &quot;test&quot;, &quot;data&quot;, &quot;2010_BSA_Carrier_PUF.csv.gz&quot;);
@time df1 = DataFrame(uCSV.read(GDS(open(carrier_file)), header=1, typedetectrows=2, encodings=Dict(&quot;&quot; =&gt; null), types=Dict(3 =&gt;  Union{String, Null})));
@time df2 = CSV.read(GDS(open(carrier_file)), types=Dict(3 =&gt; Union{String, Null}, 4 =&gt; String, 5 =&gt; String, 8 =&gt; String));
# I was unable to get TextParse.jl to read this file correctly
@time df3 = textparse2DF(csvread(GDS(open(carrier_file)), pooledstrings=false, type_detect_rows=228990, nastrings=[&quot;&quot;]));
@test_broken df1 == df2 == df3
@test df1 == df2</code></pre><pre><code class="language-julia">julia&gt; carrier_file = joinpath(Pkg.dir(&quot;uCSV&quot;), &quot;test&quot;, &quot;data&quot;, &quot;2010_BSA_Carrier_PUF.csv.gz&quot;);

julia&gt; @time df1 = DataFrame(uCSV.read(GDS(open(carrier_file)), header=1, typedetectrows=2, encodings=Dict(&quot;&quot; =&gt; null), types=Dict(3 =&gt;  Union{String, Null})));
 30.019385 seconds (97.68 M allocations: 4.060 GiB, 34.44% gc time)

julia&gt; @time df2 = CSV.read(GDS(open(carrier_file)), types=Dict(3 =&gt; Union{String, Null}, 4 =&gt; String, 5 =&gt; String, 8 =&gt; String));
 12.599813 seconds (77.04 M allocations: 1.809 GiB, 27.03% gc time)

julia&gt; # I was unable to get TextParse.jl to read this file correctly
       @time df3 = textparse2DF(csvread(GDS(open(carrier_file)), pooledstrings=false, type_detect_rows=228990, nastrings=[&quot;&quot;]));
 14.742316 seconds (49.82 M allocations: 2.733 GiB, 38.07% gc time)

julia&gt; @test_broken df1 == df2 == df3
Test Broken
Expression: df1 == df2 == df3


julia&gt; @test df1 == df2
Test Passed
</code></pre><h3><a class="nav-anchor" id="[Human-Genome-Feature-Format](https://github.com/cjprybol/uCSV.jl/blob/master/test/data/Homo_sapiens.GRCh38.90.gff3.gz)-1" href="#[Human-Genome-Feature-Format](https://github.com/cjprybol/uCSV.jl/blob/master/test/data/Homo_sapiens.GRCh38.90.gff3.gz)-1"><a href="https://github.com/cjprybol/uCSV.jl/blob/master/test/data/Homo_sapiens.GRCh38.90.gff3.gz">Human Genome Feature Format</a></a></h3><pre><code class="language-julia">genome_file = joinpath(Pkg.dir(&quot;uCSV&quot;), &quot;test&quot;, &quot;data&quot;, &quot;Homo_sapiens.GRCh38.90.gff3.gz&quot;);
@time df1 = DataFrame(uCSV.read(GDS(open(genome_file)), delim=&#39;\t&#39;, comment=&#39;#&#39;, types=Dict(1 =&gt; String)));
@time df2 = CSV.read(IOBuffer(join(filter(line -&gt; !startswith(line, &#39;#&#39;), readlines(GDS(open(genome_file)))), &#39;\n&#39;)), delim=&#39;\t&#39;, types=Dict(1 =&gt; String, 2 =&gt; String, 3 =&gt; String, 6 =&gt; String, 7 =&gt; String, 8 =&gt; String, 9 =&gt; String), header=[:x1, :x2, :x3, :x4, :x5, :x6, :x7, :x8, :x9]);
@test_broken df3 = textparse2DF(csvread(IOBuffer(join(filter(line -&gt; !startswith(line, &#39;#&#39;), readlines(GDS(open(genome_file)))), &#39;\n&#39;)), &#39;\t&#39;, pooledstrings=false));
@test df1 == df2</code></pre><pre><code class="language-julia">julia&gt; genome_file = joinpath(Pkg.dir(&quot;uCSV&quot;), &quot;test&quot;, &quot;data&quot;, &quot;Homo_sapiens.GRCh38.90.gff3.gz&quot;);

julia&gt; @time df1 = DataFrame(uCSV.read(GDS(open(genome_file)), delim=&#39;\t&#39;, comment=&#39;#&#39;, types=Dict(1 =&gt; String)));
 28.335226 seconds (94.83 M allocations: 4.768 GiB, 41.27% gc time)

julia&gt; @time df2 = CSV.read(IOBuffer(join(filter(line -&gt; !startswith(line, &#39;#&#39;), readlines(GDS(open(genome_file)))), &#39;\n&#39;)), delim=&#39;\t&#39;, types=Dict(1 =&gt; String, 2 =&gt; String, 3 =&gt; String, 6 =&gt; String, 7 =&gt; String, 8 =&gt; String, 9 =&gt; String), header=[:x1, :x2, :x3, :x4, :x5, :x6, :x7, :x8, :x9]);
 22.957273 seconds (86.07 M allocations: 3.899 GiB, 42.63% gc time)

julia&gt; @test_broken df3 = textparse2DF(csvread(IOBuffer(join(filter(line -&gt; !startswith(line, &#39;#&#39;), readlines(GDS(open(genome_file)))), &#39;\n&#39;)), &#39;\t&#39;, pooledstrings=false));

julia&gt; @test df1 == df2
Test Passed
</code></pre><h3><a class="nav-anchor" id="[Country-Indicators](https://github.com/cjprybol/uCSV.jl/blob/master/test/data/indicators.csv.gz)-1" href="#[Country-Indicators](https://github.com/cjprybol/uCSV.jl/blob/master/test/data/indicators.csv.gz)-1"><a href="https://github.com/cjprybol/uCSV.jl/blob/master/test/data/indicators.csv.gz">Country Indicators</a></a></h3><pre><code class="language-julia">indicators_file = joinpath(Pkg.dir(&quot;uCSV&quot;), &quot;test&quot;, &quot;data&quot;, &quot;indicators.csv.gz&quot;);
@time df1 = DataFrame(uCSV.read(GDS(open(indicators_file)), quotes=&#39;&quot;&#39;));
@time df2 = CSV.read(GDS(open(indicators_file)), header=[:x1, :x2, :x3, :x4, :x5, :x6], types=Dict(1 =&gt; String, 2 =&gt; String, 3 =&gt; String, 4 =&gt; String));
@time df3 = textparse2DF(csvread(GDS(open(indicators_file)), pooledstrings=false, header_exists=false, colnames=[:x1, :x2, :x3, :x4, :x5, :x6]));
# CSV.read &amp; csvread both incorrectly parse the Float64s in the final column
@test_broken df1 == df2 == df3
@test eltype.(df1.columns) == eltype.(df2.columns) == eltype.(df3.columns)</code></pre><pre><code class="language-julia">julia&gt; indicators_file = joinpath(Pkg.dir(&quot;uCSV&quot;), &quot;test&quot;, &quot;data&quot;, &quot;indicators.csv.gz&quot;);

julia&gt; @time df1 = DataFrame(uCSV.read(GDS(open(indicators_file)), quotes=&#39;&quot;&#39;));
 38.058086 seconds (149.67 M allocations: 7.614 GiB, 47.15% gc time)

julia&gt; @time df2 = CSV.read(GDS(open(indicators_file)), header=[:x1, :x2, :x3, :x4, :x5, :x6], types=Dict(1 =&gt; String, 2 =&gt; String, 3 =&gt; String, 4 =&gt; String));
 17.559485 seconds (55.74 M allocations: 1.922 GiB, 26.93% gc time)

julia&gt; @time df3 = textparse2DF(csvread(GDS(open(indicators_file)), pooledstrings=false, header_exists=false, colnames=[:x1, :x2, :x3, :x4, :x5, :x6]));
 13.672462 seconds (13.38 M allocations: 1.384 GiB, 26.24% gc time)

julia&gt; @test eltype.(df1.columns) == eltype.(df2.columns) == eltype.(df3.columns)
true
</code></pre><h3><a class="nav-anchor" id="[Yellow-Taxi](https://s3.amazonaws.com/nyc-tlc/tripdata/yellow_tripdata_2015-01.csv)-1" href="#[Yellow-Taxi](https://s3.amazonaws.com/nyc-tlc/tripdata/yellow_tripdata_2015-01.csv)-1"><a href="https://s3.amazonaws.com/nyc-tlc/trip+data/yellow_tripdata_2015-01.csv">Yellow Taxi</a></a></h3><pre><code class="language-julia">taxi_file = joinpath(homedir(), &quot;Downloads&quot;, &quot;yellow_tripdata_2015-01.csv&quot;);
@time df1 = DataFrame(uCSV.read(taxi_file, header=1, typedetectrows=6, types=Dict(18=&gt;Union{Float64, Null}), encodings=Dict(&quot;&quot; =&gt; null)));
# CSV.read parses 6, 7, 10, and 11 incorrectly, again, all Float64 columns
@time df2 = CSV.read(taxi_file, types=eltype.(df1.columns));
# csvread
@time df3 = textparse2DF(csvread(taxi_file));</code></pre><pre><code class="language-julia">julia&gt; @time df1 = DataFrame(uCSV.read(taxi_file, header=1, typedetectrows=6, types=Dict(18=&gt;Union{Float64, Null}), encodings=Dict(&quot;&quot; =&gt; null)));
224.209436 seconds (780.01 M allocations: 32.626 GiB, 33.88% gc time)

julia&gt; @time df2 = CSV.read(taxi_file, types=eltype.(df1.columns));
112.266853 seconds (692.94 M allocations: 13.221 GiB, 72.15% gc time)

julia&gt; @time df3 = textparse2DF(csvread(taxi_file));
 67.999334 seconds (28.69 M allocations: 3.790 GiB, 56.92% gc time)
</code></pre><h2><a class="nav-anchor" id="Write-1" href="#Write-1">Write</a></h2><p>If you&#39;re interested in seeing this, let me know by filing an issue or by running some comparisons yourself and opening a PR with the results!</p><footer><hr/><a class="previous" href="write.html"><span class="direction">Previous</span><span class="title">Writing Data</span></a></footer></article></body></html>
